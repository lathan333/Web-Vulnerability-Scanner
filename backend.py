from flask import Flask, request, jsonify
from flask_cors import CORS
from scanner import crawl_website, detect_vulnerabilities, generate_report

app = Flask(__name__)
CORS(app)


@app.route('/scan', methods=['POST'])
def scan_website():
    url = request.json['url']
    # Crawl the website using libraries like Requests or Scrapy
    website_data = crawl_website(url)
    # Perform vulnerability detection using libraries like OWASP ZAP or W3af
    vulnerabilities = detect_vulnerabilities(website_data)
    # Generate detailed reports
    report = generate_report(vulnerabilities)
    return jsonify(report)

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000)
